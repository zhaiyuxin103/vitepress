import{_ as s,o as n,c as a,S as p}from"./chunks/framework.8b0da900.js";const l="/vitepress/images/PHP/使用Composer管理Git-Hooks/install.png",f=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"programe/PHP/使用 Composer 管理 Git Hooks.md","filePath":"programe/PHP/使用 Composer 管理 Git Hooks.md","lastUpdated":1696179720000}'),o={name:"programe/PHP/使用 Composer 管理 Git Hooks.md"},e=p('<div class="tip custom-block"><p class="custom-block-title">TIP</p><p>本文以 MacOS 12.1、<a href="https://laravel.com/" target="_blank" rel="noreferrer">Laravel 10.x</a> 框架为例</p></div><h2 id="安装扩展包" tabindex="-1">安装扩展包 <a class="header-anchor" href="#安装扩展包" aria-label="Permalink to &quot;安装扩展包&quot;">​</a></h2><p>根目录下：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-light"><code><span class="line"><span style="color:#6F42C1;">composer</span><span style="color:#24292E;"> </span><span style="color:#032F62;">require</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--dev</span><span style="color:#24292E;"> </span><span style="color:#032F62;">brainmaestro/composer-git-hooks:v3.0.0-alpha.1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如下图：</p><p><img src="'+l+`" alt="file"></p><h2 id="修改配置" tabindex="-1">修改配置 <a class="header-anchor" href="#修改配置" aria-label="Permalink to &quot;修改配置&quot;">​</a></h2><blockquote><p>修改 <code>composer.json</code> 文件</p></blockquote><ol><li><p>添加 <code>scripts</code> 选项</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-light has-diff"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;scripts&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;post-update-cmd&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#032F62;">&quot;@php artisan vendor:publish --tag=laravel-assets --ansi --force&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#032F62;">&quot;cghooks update&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">    ],</span></span>
<span class="line diff add"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;post-merge&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;composer install&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;post-install-cmd&quot;</span><span style="color:#24292E;">: [ </span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#032F62;">&quot;cghooks add --ignore-lock&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#032F62;">&quot;cghooks update&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line diff add"><span style="color:#24292E;">    ], </span></span>
<span class="line diff add"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;cghooks&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;vendor/bin/cghooks&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li><li><p>向 <code>extra</code> 选项中添加 <code>hooks</code> 选项</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-light has-diff"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;extra&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;laravel&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;dont-discover&quot;</span><span style="color:#24292E;">: []</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line diff add"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;hooks&quot;</span><span style="color:#24292E;">: { </span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;config&quot;</span><span style="color:#24292E;">: { </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#005CC5;">&quot;stop-on-failure&quot;</span><span style="color:#24292E;">: [ </span></span>
<span class="line diff add"><span style="color:#24292E;">          </span><span style="color:#032F62;">&quot;pre-commit&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">          </span><span style="color:#032F62;">&quot;pre-push&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line diff add"><span style="color:#24292E;">        ] </span></span>
<span class="line diff add"><span style="color:#24292E;">      }, </span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;pre-commit&quot;</span><span style="color:#24292E;">: [ </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;echo Running pre-commit hooks...&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;./vendor/bin/pint&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;echo Running tests...&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;php artisan test&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line diff add"><span style="color:#24292E;">      ], </span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;commit-msg&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;grep -qE &#39;^(feat|fix|chore|docs|style|refactor|perf|test|build|ci|revert)</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">([^)]+</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">):</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s.+</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s?(?:</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">(#</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">d+</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">))?&#39; $1 || (echo &#39;Commit message must follow Conventional Commits specification!&#39; &amp;&amp; exit 1)&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;pre-push&quot;</span><span style="color:#24292E;">: [ </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;echo Running pre-push hooks...&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;./vendor/bin/pint --test&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;echo Running tests...&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line diff add"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;php artisan test&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line diff add"><span style="color:#24292E;">      ], </span></span>
<span class="line diff add"><span style="color:#24292E;">      </span><span style="color:#005CC5;">&quot;post-merge&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;composer install&quot;</span><span style="color:#24292E;"> </span></span>
<span class="line diff add"><span style="color:#24292E;">    } </span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></li></ol><h2 id="添加-git-hooks" tabindex="-1">添加 Git Hooks <a class="header-anchor" href="#添加-git-hooks" aria-label="Permalink to &quot;添加 Git Hooks&quot;">​</a></h2><p>根目录下：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-light"><code><span class="line"><span style="color:#6F42C1;">composer</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cghooks</span><span style="color:#24292E;"> </span><span style="color:#032F62;">add</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--force-win</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>更多信息可参考：<a href="https://github.com/BrainMaestro/composer-git-hooks" target="_blank" rel="noreferrer">brainmaestro/composer-git-hooks</a></p></div>`,13),t=[e];function r(c,i,d,u,y,b){return n(),a("div",null,t)}const E=s(o,[["render",r]]);export{f as __pageData,E as default};
